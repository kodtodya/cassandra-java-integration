package com.avadhut.samples;

import com.datastax.driver.core.Cluster;
import com.datastax.driver.core.Session;
import com.datastax.driver.core.exceptions.AlreadyExistsException;
import com.datastax.driver.core.exceptions.SyntaxError;

public class CassandraConnectivity {

	private static final String KEYSPACE = "mykeyspace";
	public static void main(String[] args) {
		
		//Create the builder
		Cluster.Builder myBuilder = Cluster.builder().addContactPoint("127.0.0.1");
		
		//Creating cluster
		Cluster cluster = myBuilder.build();
		
		//Create/connect to session
		Session session = cluster.connect();
		
		//Create query to execute
		String createkeySpaceQuery="CREATE KEYSPACE "+ KEYSPACE +" WITH replication " + "= {'class':'SimpleStrategy','replication_factor':3}; ";
		
		try {
		session.execute(createkeySpaceQuery);

		System.out.println(createkeySpaceQuery);

		System.out.println("KEYSPACE "+ KEYSPACE +" created on 127.0.0.1..");
		}catch (AlreadyExistsException e) {
			System.err.println(e.equals(e.getMessage()));
		}
		
		String alterKeySpaceQuery = "ALTER KEYSPACE " + KEYSPACE + " WITH replication = {'class': 'SimpleStrategy'," + "'replication_factor' : '"+ 1 +"'};";

		try {
		session.execute(alterKeySpaceQuery);
		System.out.println(alterKeySpaceQuery);
		System.out.println("KEYSPACE "+ KEYSPACE +" altered on 127.0.0.1..");
		}catch (SyntaxError e) {
			System.err.println(e.getMessage());
		}
	}

}
